function BurnedComp = CRAMsolve(Matrix,Timestep,InitComp)
%CRAMSOLVE solves burnup equation with CRAM method of order 16

    theta=[ -1.0843917078696988026e1+1.9277446167181652284e1*1i
 -5.2649713434426468895e0+1.6220221473167927305e1*1i
 +5.9481522689511774808e0+3.5874573620183222829e0*1i
 +3.5091036084149180974e0+8.4361989858843750826e0*1i
 +6.4161776990994341923e0+1.1941223933701386874e0*1i
 +1.4193758971856659786e0+1.0925363484496722585e1*1i
 +4.9931747377179963991e0+5.9968817136039422260e0*1i
 -1.4139284624888862114e0+1.3497725698892745389e1*1i];    
    alpha=[-5.0901521865224915650e-7-2.4220017652852287970e-5*1i
 +2.1151742182466030907e-4+4.3892969647380673918e-3*1i
 +1.1339775178483930527e2+1.0194721704215856450e2*1i
 +1.5059585270023467528e1-5.7514052776421819979e0*1i
 -6.4500878025539646595e1-2.2459440762652096056e2*1i
 -1.4793007113557999718e0+1.7686588323782937906e0*1i
 -6.2518392463207918892e1-1.1190391094283228480e1*1i
 +4.1023136835410021273e-2-1.5743466173455468191e-1*1i];
    alpha_0=2.1248537104952237488e-16;

tol=1.0e-12;
maxIter=100;

BurnedComp=0.0*InitComp;
A=Matrix*Timestep;

for j=1:length(theta)
    M=sparse(A-theta(j)*eye(size(A)));
    %M=(A-theta(j)*eye(size(A)));
    [L,U]=ilu(M);
    %[L,U]=lu(M,'vector');
    BurnedComp=BurnedComp+bicgstab(M,alpha(j)*InitComp,tol,maxIter,L,U,InitComp);
    %[compChange,~]=cgs(M,alpha(j)*InitComp,tol,maxIter,L,U);
    %BurnedComp=BurnedComp+compChange;
end
BurnedComp=2*real(BurnedComp)+alpha_0*InitComp;
BurnedComp(BurnedComp<0.0)=0.0;
end
function BurnedComp = CRAMsolve(Matrix,Timestep,InitComp)
%CRAMSOLVE solves burnup equation with CRAM method of order 16

Halphen=9.3; %Halphen constant

theta=[ -1.0843917078696988026E1+1.9277446167181652284E1*1i
 -5.2649713434426468895E0+1.6220221473167927305E1*1i
 +5.9481522689511774808E0+3.5874573620183222829E0*1i
 +3.5091036084149180974E0+8.4361989858843750826E0*1i
 +6.4161776990994341923E0+1.1941223933701386874E0*1i
 +1.4193758971856659786E0+1.0925363484496722585E1*1i
 +4.9931747377179963991E0+5.9968817136039422260E0*1i
 -1.4139284624888862114E0+1.3497725698892745389E1*1i];    
    alpha=[-5.0901521865224915650E-7-2.4220017652852287970E-5*1i
 +2.1151742182466030907E-4+4.3892969647380673918E-3*1i
 +1.1339775178483930527E2+1.0194721704215856450E2*1i
 +1.5059585270023467528E1-5.7514052776421819979E0*1i
 -6.4500878025539646595E1-2.2459440762652096056E2*1i
 -1.4793007113557999718E0+1.7686588323782937906E0*1i
 -6.2518392463207918892E1-1.1190391094283228480E1*1i
 +4.1023136835410021273E-2-1.5743466173455468191E-1*1i];
    alpha_0=2.1248537104952237488E-16;

tol=1.0E-8; maxIter=50;

BurnedComp=0.0*InitComp;
A=Matrix*Timestep;
for j=1:length(theta)
    M=A-theta(j)*speye(size(A));
    [L,U]=ilu(M);
    [change,flag,res,iter]=bicgstab(M,alpha(j)*InitComp,tol,maxIter,L,U,InitComp);
    if(flag>1)
       error('Problem while solving CRAM!') 
    end
    BurnedComp=BurnedComp+change;
end
BurnedComp=2*real(BurnedComp)+alpha_0*InitComp;
BurnedComp(BurnedComp<InitComp*Halphen^(-13))=0.0;

end